%!TEX root=finmath1.tex
\part{Непрерывное время}
\chapter{Случайные процессы. Броуновское движение}
\label{ch:processes}
\chaptertoc

Дальнейшая часть курс будет посвящена моделям рынков с непрерывным временем и, главным образом, модели Блэка--Шоулса.
В связи с этим нам потребуется на некоторое время (на три лекции) погрузиться в теорию случайных процессов.

\section{Основные понятия, относящиеся к случайным процессам}

В этом разделе присутствует ряд технических определений и результатов (они отмечены звездочками).
Для практических применений они не так полезны, но, чтобы сохранить строгость изложения, мы их все-таки приводим.
При первом чтении их можно пропустить.

\begin{definition}
\emph{Случайный процесс $X$} "--- это семейство случайных величин $(X_t)_{t\ge 0}$, определенных на одном вероятностном пространстве $(\Omega,\F,\P)$.
\end{definition}

Время идет непрерывно, т.е.\ запись $t\ge0$ означает $t\in[0,\infty)$.
Мы также будем рассматривать случай конечного горизонта времени $t\in[0,T]$.

\begin{definition}
\emph{Траекторией} случайного процесса $X$, соответствующей случайному исходу $\omega$, называется функция $t\mapsto X_t(\omega)$.

Случайный процесс называется \emph{непрерывным}, если все траектории непрерывны.
Аналогично определяются процессы непрерывные слева или справа, неубывающие или невозрастающие, и \td
\end{definition}

\begin{definition}[$*$]
Случайный процесс $X$ называется \emph{измеримым}, если он измерим по паре переменных $(\omega,t)$, \te\ отображение $X(\omega,t)\colon\Omega\times\R_+ \to \R$ является $\F\otimes\B(\R_+)/\B(\R)$-измеримым.
\end{definition}

Далее мы будем считать, что все рассматриваемые процессы измеримы.
Свойство измеримости будет нужно, например, для определения интеграла по броуновскому движению в лекции \ref{ch:ito-integral}, а также в ряде других мест.
Следующее предложение дает простое достаточное условие измеримости, которое будет выполнено для большинства процессов, встречающихся далее в курсе.

\begin{proposition}[$*$]
Если случайный процесс $X$ непрерывен слева или непрерывен справа, то он измерим.
\end{proposition}

\begin{proof}
Непрерывный слева процесс $X$ можно приблизить кусочно"=постоянными процессами $X^n(\omega,t) = X(\omega, [nt]/n)$, \te\ для всех $t$ и $\omega$
\[
\lim_{n\to\infty} X^n(\omega,t) = X(\omega,t).
\]
Нетрудно проверить, что кусочно-постоянные процессы измеримы. Тогда $X$ измерим как предел измеримых отображений $X^n$.
Аналогично для непрерывных слева процессов.
\end{proof}

Следующее определение вводит понятие равенства случайных процессов.
(Полезно вспомнить, что для случайных величин вводят как минимум два понятия равенства: почти наверное и по распределению.)

\begin{definition}
Случайные процессы $X$ и $Y$ называются
\begin{itemize}
\item \emph{неразличимыми}, если у них \as\ совпадают траектории, \te\ $\P(\omega: X_t(\omega) = Y_t(\omega)\allowbreak \text{ для всех $t$}) = 1$;
\item \emph{эквивалентными}, если $X_t = Y_t$ \as\ для всех $t$ (синоним: $X$ является \emph{модификацией} $Y$);
\item \emph{одинаково распределенными}, если у них совпадают все конечномерные распределения, \te\ $(X_{t_1},\dots,X_{t_n}) = (Y_{t_1},\dots,Y_{t_n})$ по распределению для любых моментов времени $t_1,\dots,t_n$.
\end{itemize}
В этих определениях предполагается, что интервалы времени, на которых заданы оба процесса, одинаковы.
В определении неразличимости и эквивалентности считается, что процессы заданы на одном вероятностном пространстве.
\end{definition}

\begin{proposition}
Если процессы $X$ и $Y$ неразличимы, то они эквивалентны.
Если процессы $X$ и $Y$ непрерывны слева или непрерывны справа, то они неразличимы тогда и только тогда, когда они эквивалентны. 
\end{proposition}

\begin{proof}[Доказательство $(*)$]
Событие $\{\omega: X_t(\omega) \neq Y_t(\omega)\}$ является подмножеством события $\{\omega: X_t(\omega) \neq Y_t(\omega)\ \text{для некоторого $t$}\}$.
Поэтому если второе имеет нулевую вероятность, то и первое тоже.
Значит, из неразличимости следует эквивалентность.

Пусть теперь процессы $X$ и $Y$ непрерывны слева и эквивалентны (для непрерывных справа доказательство аналогично).
Воспользуемся тем, что любая непрерывная слева функция на $\R_+$ определяется по своим значениям на множестве неотрицательных рациональных чисел.
Тогда
\[
\{\omega: X_t(\omega) = Y_t(\omega)\ \text{для всех}\ t\}
= \bigcap_{t\in\mathbb{Q}_+} \{\omega: X_t(\omega) = Y_t(\omega)\}.
\]
В правой части берется пересечение счетного числа множеств.
Поэтому если каждое из этих множества имеет вероятность 1, то и пересечение имеет вероятность~1.
Следовательно, эквивалентность влечет неразличимость.
\end{proof}

Далее будем предполагать, что вероятностное пространство снабжено \emph{фильтрацией} $\FF=(\F_t)_{t\ge0}$, \te\ семейством $\sigma$-алгебр $\F_t$ таких, что $\F_s \subseteq \F_t$ для всех $s\le t$.
Аналогично определяется фильтрация для конечного горизонта времени. 

\begin{definition}
Случайный процесс $X$ называется \emph{согласованным с фильтрацией $\FF$}, если для каждого $t$ случайная величина $X_t$ является $\F_t$-измеримой.
\end{definition}

\begin{definition}
Фильтрацией, \emph{порожденной} процессом $X$ (или \emph{естественной фильтрацией} процесса $X$) называется семейство $\sigma$-алгебр $\F_t = \sigma(X_s,\ s\le t)$, \te\ $\F_t$ "--- это наименьшая $\sigma$-алгебра, относительно которой измеримы случайные величины $X_s$ для всех $s \le t$.
\end{definition}

\begin{remark}
Любой процесс согласован со своей естественной фильтрацией.
\end{remark}

\begin{remark}[$*$]
Для случайных последовательностей мы ввели еще понятие предсказуемости: величины $X_t$ должны быть измеримы относительно $\F_{t-1}$.
Соответствующее определение для случайных процессов более деликатно%
\footnote{Определение такое: процесс $X$ \emph{предсказуем}, если отображение $X(\omega,t)$ измеримо относительно \emph{предсказуемой $\sigma$-алгебры $\mathcal{P}$} на $\Omega\times\R_+$, которая по определению порождается всеми непрерывными согласованными процессами.},
так как в непрерывном времени нет <<предыдущего момента времени>>.
В этом курсе понятие предсказуемости нам не потребуется, хотя оно и играет важную роль в финансовой математике для общих моделей рынка в непрерывном времени.
\end{remark}

Следующее условие необходимо в разных технических результатах теории случайных процессов\footnote{Например, в теореме о существовании непрерывной справа и имеющей пределы слева модификации произвольного мартингала (см.~\cite{BulinskiShiryaev04}, стр.~142)}.
В финансовой математике можно считать его всегда выполненным, так как это не уменьшает общности рассуждений.

\begin{definition}[$*$]
Говорят, что фильтрованное вероятностное пространство $(\Omega,\F,\FF,\P)$ удовлетворяет \emph{обычным условиям}, если
\begin{alphenum}
\item вероятностное пространство $(\Omega,\F,\P)$ \emph{полно}, \te\ если событие $A\in\F$ имеет нулевую вероятность, то $B\in\F$ для любого подмножества $B\subseteq A$;
\item $\F_0$ содержит все события из $\F$ нулевой вероятности;
\item фильтрация $\FF$ непрерывна справа, \te\ $\F_t = \bigcap_{s>t} \F_s$ для всех $t\ge0$.
\end{alphenum}
\end{definition}


\section{Броуновское движение}
\subsection{Определение}

\begin{definition}
\emph{Броуновским движением} (или \emph{винеровским процессом}) на фильтрованном вероятностном пространстве $(\Omega,\F,\FF,\P)$ называется случайный процесс $W=(W_t)_{t\ge0}$ со следующими свойствами:
\begin{enumerate}
\item $W$ согласован с фильтрацией $\FF$;
\item $W_0=0$ п.н.;
\item для любых $0\le s<t$ приращение $W_t-W_s$ не зависит от $\F_s$;
\item $W_t-W_s$ имеет нормальное распределение с математическим ожиданием 0 и дисперсией $t-s$, \te\ $W_t-W_s\sim N(0,t-s)$;
\item траектории $W$ непрерывны.
\end{enumerate}
\end{definition}

\begin{remark}
\begin{enumerate}
\item Из определения следует, что $W_t=W_t-W_0\sim N(0,t)$. 

\item Если фильтрация не указывается, то обычно имеется ввиду, что броуновское движение задано относительно своей естественной фильтрации.

\item Используя теорему Колмогорова о непрерывной модификации, можно показать, что если процесс $W$ удовлетворяет свойствам 1--3, то у него существует непрерывная модификация.
По этой причине условие непрерывности траекторий часто не включают в определение.

\item В литературе также часто используется символ $B$ для обозначения броуновского движения (B "--- Brownian, W "--- Wiener). У нас он будет занят под обозначение цены безрискового актива.
\end{enumerate}
\end{remark}

\begin{proposition}
Для любых моментов времени $0\le t_1<\dots<t_n$ случайный вектор $\xi = (W_{t_1}, \ldots, W_{t_n})$ имеет многомерное нормальное распределение со средним $\E W_{t_i} = 0$ и ковариацией $\cov(W_{t_i}, W_{t_j}) = \min(t_i,t_j)$.
\end{proposition}

\begin{proof}
Вектор $\zeta = (W_{t_1}, W_{t_2} - W_{t_1}, \ldots, W_{t_n} - W_{t_{n-1}})$ имеет нормальное распределение в силу того, что его компоненты нормально распределены и независимы. 
Вектор $\xi$ можно получить из $\zeta$ с помощью линейного преобразования, а именно
\[
W_{t_i} = \sum_{j=1}^i (W_{t_j} - W_{t_{j-1}}) + W_{t_1}.
\]
Следовательно, $\xi$ тоже имеет нормальное распределение. 
Кроме того, $\E W_{t_i} = \E (W_{t_i} - W_{0}) = 0$, и для любых $i < j$
\begin{multline*}
\cov(W_{t_i}, W_{t_j}) = E(W_{t_i}W_{t_j}) = \E (W_{t_i}(W_{t_j} - W_{t_i} + W_{t_i})) \\
= \E (W_{t_i}W_{t_i}) + \E (W_{t_i}(W_{t_j} - W_{t_i})) = t_i + 0 = t_i.
\end{multline*}
\end{proof}

\begin{remark}
Напомним, что многомерное нормальное распределение однозначно задается своим вектором средних и ковариационной матрицей.
Таким образом, предыдущее предложение характеризует конечномерные распределения броуновского движения.

Случайный процесс, у которого все конечномерные распределения являются нормальными, называется \emph{гауссовским процессом}.
Подобно многомерному нормальному распределению, гауссовский процесс характеризуется своей функцией среднего $\mu(t) = \E X_t$ и ковариационной функцией $\sigma(s,t) = \cov(X_s,S_t)$.
Это дает эквивалентное определение броуновского движения, которое часто встречается в литературе: это непрерывный гауссовский процесс с нулевым средним и ковариационной функцией $\sigma(s,t) = \min(s,t)$.
\end{remark}

На рис.~\ref{6:trajectory} показано, как выглядят типичные траектории броуновского движения.
Видно, что они устроены весьма хаотично и нерегулярно.
Следующее предложение содержит хорошо известные свойства траекторий броуновского движения. 
Доказательство можно найти во многих учебниках по случайным процессам (см., например, гл.~III в \cite{BulinskiShiryaev04}).

\begin{proposition}
С вероятностью 1 траектории броуновского движения не дифференцируемы ни в одной точке, не имеют точек роста и убывания, а также имеют бесконечную вариацию на любом отрезке $[a,b]$, где $a<b$.
\end{proposition}

\begin{figure}[h]
\centering
\begin{tikzpicture}[xscale=3.5]
\draw[thick,->] (0,0) node[below left] {\footnotesize $0$} -- (1.1,0) node[below] {\footnotesize $t$};
\draw[thick,->] (0,-1.5) -- (0,2.1) node[left] {\footnotesize $B$};
\input{pic/bm1}
\end{tikzpicture}
\begin{tikzpicture}[xscale=3.5]
\draw[thick,->] (0,0) node[below left] {\footnotesize $0$} -- (1.1,0) node[below] {\footnotesize $t$};
\draw[thick,->] (0,-1.5) -- (0,2.1) node[left] {\footnotesize $B$};
\input{pic/bm2}
\end{tikzpicture}
\begin{tikzpicture}[xscale=3.5]
\draw[thick,->] (0,0) node[below left] {\footnotesize $0$} -- (1.1,0) node[below] {\footnotesize $t$};
\draw[thick,->] (0,-1.5) -- (0,2.1) node[left] {\footnotesize $B$};
\input{pic/bm3}
\end{tikzpicture}
\caption{Траектории броуновского движения.}
\label{6:trajectory}
\end{figure}


\subsection{Мартингальное и марковское свойства броуновского движения}

\begin{definition}
Случайный процесс $X$ называется \emph{мартингалом} относительно фильтрации $\FF$, если
\begin{alphenum}
\item он согласован с фильтрацией $\FF$;
\item $\E|X_t| < \infty$ для всех $t$;
\item $\E(X_t\mid\F_s) = X_s$ \as\ для всех $s\le t$.
\end{alphenum}
Если в последнем условии заменить равенство на неравенство $\ge$, то получим определение \emph{субмартингала}, а если на $\le$, то определение \emph{супермартингала}.
\end{definition}

\begin{proposition}
Броуновское движение является мартингалом.
\end{proposition}
\begin{proof}
Имеем
\[
\E(W_t\mid\F_s) = \E(W_t - W_s + W_s\mid\F_s) 
= W_s + \E(W_t - W_s) = W_s,
\]
где воспользовались тем, что приращение $W_t - W_s$ не зависит от $\F_s$ и имеет нулевое математическое ожидание.
\end{proof}

\begin{remark}
Точно так же доказывается, что любой процесс с независимыми приращениями и $\E X_t\equiv c$ является мартингалом.  
\end{remark}

\begin{definition}
Процесс $X$ называется \emph{марковским} относительно фильтрации $\FF$, если для любых $s\le t_1<\dots<t_n$ и борелевских множеств $A_1,\dots,A_n$ выполнено равенство%
\footnote{Условная вероятность события $B$ относительно $\sigma$-алгебры $\G$ определяется как условное математическое ожидание соответствующего индикатора: $\P(B\mid\G) = \E (I_B \mid \G)$.}
\begin{equation}
\label{5:markov}
\P(X_{t_1}\in A_1,\dots,X_{t_n}\in A_n\mid\F_s) = \P(X_{t_1}\in A_1,\dots,X_{t_n}\in A_n\mid X_s)\ \text{п.н.}
\end{equation}
\end{definition}

Смысл этого определения состоит в следующем: для того, чтобы знать условное распределение значений процесса в будущем (\te\ конечномерное распределение $(X_{t_1},\dots,X_{t_n})$), достаточно знать его значение в текущий момент времени $s$, но не нужно знать всю предыдущую информацию, содержащуюся в $\F_s$.

Эквивалентное определение марковского процесса можно получить, если заменить формулу \eqref{5:markov} на условие, что для любой функции $f$, удовлетворяющей условию $\E|f(X_{t_1},\dots,X_{t_n})|<\infty$, выполнено равенство
\[
\E(f(X_{t_1},\dots,X_{t_n})\mid\F_s) = \E(f(X_{t_1},\dots,X_{t_n})\mid X_s)\ \text{п.н.}
\]

Следующее определение дает удобное понятие для работы с условными распределениями марковского процесса.

\begin{definition}
\label{pr:markov-transition}
Функция $\P(s,x,t,A)$ с аргументами $0\le s \le t$, $x\in\R$, $A\in\B(\R)$ называется \emph{марковской переходной функцией}, если
\begin{alphenum}
\item при фиксированных $s,x,t$ функция $B\mapsto P(s,x,t,A)$ является вероятностной мерой на $\B(\R)$;
\item при фиксированных $s,t,A$ функция $x\mapsto P(s,x,t,A)$ измерима;
\item $\P(s,x,s,A) = \I(x\in A)$ для любых $s,x,A$;
\item для любого $u\in[s,t]$ выполнено \emph{уравнение Колмогорова"--~Чепмена}:
\[
P(s,x,t,A) = \int_\R P(u,y,t,A) P(s,x,u,\,dy).
\]
\end{alphenum}
Говорят, что марковский процесс $X$ обладает переходной функцией $\P(s,x,t,A)$, если $\P(X_t \in A\mid X_s = x) = \P(s,x,t,A)$ \as\ для всех $s,x,t,A$.
%\footnote{Напомним, что условное математическое ожидание $\E(X\mid Y)$ можно представить как функцию $g(Y)$.
%Тогда запись $\E(X\mid Y=y)$ обозначает значение $g(y)$; см.~лекцию \ref{ch:mart}.}
\end{definition}

Переходную функцию нужно понимать как вероятность того, что, начиная из точки $x$ в момент времени $s$, процесс попадет в множество $A$ в момент времени $t$.
Условия a) и b) в определении \ref{pr:markov-transition} "--- технические, они гарантируют, что переходная функция <<хорошо устроена>>.
Условие c) означает, что если $t=s$, то процесс <<никуда не уйдет>> за нулевое время.
Уравнение Колмогорова"--~Чепмена (условие d) имеет следующий смысл: вероятность перехода из точки $x$ в множество $A$ за время $[s,t]$ может быть найдена из вероятностей перехода из точки $x$ в промежуточную точку $y$ за время $[s,u]$ и из $y$ в множество $A$ за время $[u,t]$, где $y$ пробегает всевозможные значения.

Известно, что у любого марковского процесса со значениями в $\R$ (или в $\R^n$) переходная функция существует.

\begin{definition}
Марковская переходная функция (или соответствующий ей марковский процесс) называется \emph{однородной}, если она зависит только от разности $t-s$, \te\ $\P(s,x,t,A) = \P(0,x,t-s,A)$.
\end{definition}

\begin{definition}
Если для всех $s<t$ и $x$ переходная функция марковского процесса $X$ обладает плотностью $p(s,x,t,y)$, \te\ выполнено равенство
\[
\P(s,x,t,A) = \int_A p(s,x,t,y)\,dy,
\]
то функция $p(s,x,t,y)$ называется \emph{переходной плотностью} процесса $X$.
\end{definition}

\begin{proposition}
Броуновское движение является однородным марковским процессом с переходной плотностью
\[
p(s,x,t,y) = \frac{1}{\sqrt{2\pi(t-s)}}\exp\left(-\frac{(y-x)^2}{2(t-s)}\right).
\] 
\end{proposition}
\begin{remark}
Легко заметить, что $p(s,x,t,y)$ есть плотность нормального распределения со средним $x$ и дисперсией $t-s$.
\end{remark}
\begin{proof}
Марковское свойство следует из того, что приращения $W_{t_i}-W_s$ не зависят от $\F_s$ при $t_i>s$, и, следовательно%
\footnote{Здесь используется такой факт: если случайная величина $Y$ является $\G$-измеримой, а случайный вектор $X$ не зависит от $\G$, то $\E(f(X,Y) \mid \G) = g(Y)$, где $g(y) = \E(f(X,y))$.
Результат справедлив при условии, что $\E| f(X,Y)| < \infty$.}, 
\[
\E( f(W_{t_1}, \ldots, W_{t_n}) \mid \F_s)
= \E( f(W_{t_1} - W_s + W_s, \ldots, W_{t_n} - W_s + W_s) \mid \F_s)
= g(W_s),
\]
где $g(x) = \E f(W_{t_1} - W_s + x, \ldots, W_{t_n} - W_s + x)$.
Аналогично получаем
\[
\P(W_t \in B \mid W_s = x) = \P( W_t - W_s + x \in B),
\]
и тогда формула для переходной плотности следует из того, что $W_t - W_s$ имеет нормальное распределение с нулевым средним и дисперсией $t-s$.
\end{proof}


\section{Броуновское движение со сносом и геометрическое броуновское движение}

\begin{definition}
Броуновским движением с коэффициентом \emph{сноса} $\mu\in\R$, коэффициентом \emph{диффузии} $\sigma>0$ и начальным условием $x\in\R$ относительно фильтрации $\FF$ называется процесс
\[
X_t = x + \mu t + \sigma W_t,
\]
где $W$ "--- броуновское движение относительно $\FF$.

Иногда такой процесс называют \emph{общим броуновским движением} (или даже просто броуновским движением, а для $x=0$, $\mu=0$, $\sigma=1$ используют термин \emph{стандартное броуновское движение}).
\end{definition}

Следующий результат непосредственно вытекает из свойств стандартного броуновского движения.

\begin{proposition}
Общее броуновское движение является однородным марковским процессом.
Оно является мартингалом при $\mu=0$, субмартингалом при $\mu\ge0$ и супермартингалом при $\mu\le0$.
\end{proposition}

\begin{definition}
\emph{Геометрическим броуновским движением} с коэффициентом \emph{сноса} $\mu\in\R$, коэффициентом \emph{волатильности} $\sigma>0$ и начальным условием $s>0$ относительно фильтрации $\FF$ называется процесс
\[
S_t = s e^{\sigma W_t + (\mu-\frac{\sigma^2}{2})t},
\]
где $W$ "--- броуновское движение относительно $\FF$.
\end{definition}

Качественное отличие геометрического броуновского движения от обычного такое же как у мультипликативного случайного блуждания от аддитивного (см.~примеры в лекции~3).
В частности, у геометрического броуновского движения нормально распределены и независимы приращения его логарифма, а не самого процесса. 

Геометрическое броуновское движение будет играть важную роль в дальнейшем изложении.
В частности, оно задает цену рискового актива в модели \bs.

Отметим, что странный на первый взгляд член $-\frac{\sigma^2}{2}t$ в экспоненте вводится для того, чтобы сделать геометрическое броуновское движение мартингалом в случае $\mu=0$, как показывает следующее предложение.

\begin{proposition}
Геометрическое броуновское движение является однородным марковским процессом.
Оно является мартингалом при $\mu=0$, субмартингалом при $\mu\ge0$ и супермартингалом при $\mu\ge0$.
Кроме того, $\E S_t = s e^{\mu t}$.
\end{proposition}

\begin{proof}
Марковское свойство следует из того, что имеется взаимно"=однозначное соответствие между $S_t$ и $W_t$.
Мартингальное (или суб/супермартингальное) свойство следует из равенства
\[
\E (S_t \mid \F_u) = S_u \E(e^{(\mu-\frac{\sigma^2}{2})(t-u) + \sigma(W_t-W_u)}) = S_u e^{\mu(t-u)},
\]
где воспользовались тем, что $\E e^{\sigma (W_t-W_u)} = e^{\frac{\sigma^2}{2} (t-u)}$.
\end{proof}


\summary

\begin{itemize}
\item В этом курсе случайные процессы рассматриваются на фильтрованных вероятностных пространствах $(\Omega,\F,\FF,\P)$. Случайный процесс $
X$ называется согласованным с фильтрацией $\FF$, если для каждого $t$ случайная величина $X_t$ измерима относительно $\F_t$.

\item Определение броуновского движения: непрерывный случайный процесс с нулевым начальным значением и независимыми приращениями, которые имеют нормальное распределение со средним 0 и дисперсией $\D (W_t-W_s) = t-s$. Эквивалентное определение: непрерывный гауссовский процесс с нулевым средним и ковариационной функцией $\cov(W_t,W_s) = \min(s,t)$.

\item Броуновское движение является мартингалом и марковским процессом, у которого переходные вероятности задаются нормальным распределением.

\item Общее броуновское движение "--- это процесс $X_t = x + \mu t + \sigma W_t$.

\item Геометрическое броуновское движение "--- это процесс $S_t = s e^{\sigma W_t + (\mu-\frac{\sigma^2}{2})t}$. При $\mu=0$ он является мартингалом.
\end{itemize}
